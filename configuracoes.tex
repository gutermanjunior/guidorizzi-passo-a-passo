% =========================================================
% CONFIGURAÇÕES GERAIS DO LIVRO DE CÁLCULO 1
% =========================================================

% Truque para permitir a pré-visualização isolada deste arquivo na plataforma:
\ifdefined\chapter
\else
  \documentclass[12pt,a4paper]{book}
  \def\compilandoisolado{1}
\fi

% =========================================================
% 1. PACOTES ESSENCIAIS (Infraestrutura)
% =========================================================

% ATENÇÃO: Este arquivo não deve ser compilado sozinho. Use sempre o main.tex!
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}   % Removível se usar XeLaTeX/LuaLaTeX
\usepackage[brazil]{babel}
\usepackage[a4paper, margin=1.5cm]{geometry}
    \setlength{\headheight}{13pt} % O erro sugere 12.15pt, 13pt é um valor seguro.
\usepackage{microtype} % Faz ajustes invisíveis no espaçamento das letras que resolvem 90% desses problemas de margem.
\usepackage{amsmath, amssymb, amsfonts}
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{tikz}
\usepackage{titlesec}
\usepackage{makeidx} % Pacote para criar o índice remissivo
    \makeindex           % Comando que prepara o arquivo para gerar o índice
\usepackage{setspace}
\usepackage{xparse}
\usepackage[most]{tcolorbox}
\usepackage{enumitem} % Adicionado para controlar o espaçamento das listas


    % =========================================================
    % CONFIGURAÇÕES DE CABEÇALHO E RODAPÉ (fancyhdr)
    % =========================================================
    \usepackage{fancyhdr}
    \pagestyle{fancy}
    
    % Limpa as configurações padrão do LaTeX para cabeçalho e rodapé
    \fancyhf{}
    
    % Configurações para páginas Pares (Even - E) e Ímpares (Odd - O)
    % L = Left (Esquerda), R = Right (Direita), C = Center (Centro)
    
    % Número da página sempre no canto externo
    \fancyhead[LE, RO]{\textbf{\thepage}} 
    
    % Nome do Capítulo na página par (lado de dentro)
    \fancyhead[RE]{\textit{\leftmark}} 
    
    % Nome da Seção na página ímpar (lado de dentro)
    \fancyhead[LO]{\textit{\rightmark}} 
    
    % Espessura da linha divisória abaixo do cabeçalho
    \renewcommand{\headrulewidth}{0.4pt} 
    \renewcommand{\footrulewidth}{0pt} % Sem linha no rodapé
    
    % --- Ajuste para o início dos capítulos ---
    % O LaTeX usa automaticamente o estilo 'plain' na primeira página de cada capítulo.
    % Vamos redefini-lo para não mostrar o cabeçalho nessas páginas (fica mais elegante).
    \fancypagestyle{plain}{
        \fancyhf{} % Limpa tudo
        \fancyfoot[C]{\textbf{\thepage}} % Coloca o número da página no rodapé centralizado
        \renewcommand{\headrulewidth}{0pt} % Remove a linha do cabeçalho
        \renewcommand{\footrulewidth}{0pt}
    }

    % =========================================================
    % METADADOS DO LIVRO
    % =========================================================
    
    \newcommand{\thetitle}{Cálculo 1}
    \newcommand{\thesubtitle}{Números Reais e Funções Básicas}
    \newcommand{\theauthor}{Prof. Guterman Junior}
    \newcommand{\thedate}{19 de fevereiro 2026}
    
    % =========================================================
    % CONFIGURAÇÃO DE LINKS E INTERATIVIDADE (hyperref)
    % =========================================================
    \usepackage[
        colorlinks=true,
        linkcolor=corprincipal, % Links internos (sumário, refs) na cor do seu tema
        filecolor=magenta,      
        urlcolor=cyan,
        pdftitle={\thetitle},
        pdfauthor={\theauthor},
        breaklinks=true,
    ]{hyperref}
    
    % Comando para criar um destino de link automático para cada exercício
    \newcommand{\targetex}[2]{\hypertarget{sol:#1:#2}{}}

% =========================================================
% 2. IDENTIDADE VISUAL (cores e tema)
% =========================================================

\definecolor{corprincipal}{RGB}{30, 60, 120}
\definecolor{corclara}{RGB}{220, 230, 240}
\definecolor{corpasso}{RGB}{245, 245, 210}

% =========================================================
% 3. CONFIGURAÇÕES TIPOGRÁFICAS GERAIS (Ajustadas para densidade)
% =========================================================

\singlespacing % Alterado de onehalfspacing para espaçamento simples
\raggedbottom
\setlength{\parindent}{0pt}
\setlength{\parskip}{0.2em} % Reduzido de 0.5em para juntar mais os parágrafos

% Configuração das listas para não terem espaços extras (mais denso)
\setlist[itemize]{label=-, nosep, leftmargin=*}

% =========================================================
% 4. FORMATAÇÃO DE TÍTULOS
% =========================================================

\titleformat{\chapter}
  {\normalfont\huge\bfseries\color{corprincipal}}
  {\thechapter}{1em}{}
  [\vspace{1ex}\titlerule]

% =========================================================
% 5. CAIXAS E AMBIENTES PERSONALIZADOS (Mais compactos)
% =========================================================

\newcommand{\registrasolucao}[3]{
    \vspace{0.5em}
    \targetex{#1}{#2} % Cria o alvo invisível: sol:secao:exercicio
    \noindent\fcolorbox{black!20}{black!5}{%
        \parbox{\dimexpr\textwidth-2\fboxsep-2\fboxrule\relax}{%
            \textbf{Exercício #2} (Seção #1) [cite: 60]
        }%
    }\par\vspace{0.2em}
    #3
    \vspace{0.3em}
}

\newcommand{\exespaco}[2]{\noindent $\square$ Exercício #2 (Seção #1) - \textit{Reservado}\par}

\newenvironment{resumocapitulo}
  {\vspace{0.5em}\begin{quote}\itshape}
  {\end{quote}\vspace{0.5em}}

\newtcolorbox{atencao}{
    colback=red!5, 
    colframe=red!75!black, 
    title=\textbf{Cuidado!},
    arc=2mm,
    boxrule=0.5mm
}

\newenvironment{passo}[1]
  {\par\vspace{0.2em}\noindent\textbf{Passo #1}\par\noindent}
  {\par}

% =========================================================
% 6. CAPA
% =========================================================

\newcommand{\makemytitle}{
\begin{titlepage}

\begin{tikzpicture}[remember picture, overlay]
    \fill[corprincipal!5] 
    (current page.north west) rectangle (current page.south east);
\end{tikzpicture}

\vspace*{2cm}

\begin{center}

\begin{tcolorbox}[
    colback=corprincipal!10,
    colframe=corprincipal,
    width=0.85\textwidth,
    boxrule=1mm,
    arc=4mm,
    center title]
    {\Huge \textbf{\thetitle}}\\[0.5cm]
    {\Large \textit{\thesubtitle}}
\end{tcolorbox}

\vspace{1.5cm}

{\Large \textbf{\theauthor}}\\[0.3cm]
{\large \thedate}

\vspace{2cm}

\begin{tikzpicture}
    \draw[corprincipal, thick] (0,0) -- (5,0);
    \draw[corprincipal!60, dashed] (0.2,0.2) -- (4.8,0.2);
\end{tikzpicture}

\vfill

{\small Material didático desenvolvido para estudo passo a passo.}

\end{center}
\end{titlepage}
}

% =========================================================
% PREVIEW ISOLADO (Apenas para a plataforma)
% =========================================================
\ifdefined\compilandoisolado
  \begin{document}
  \chapter*{Arquivo de Configurações}
  \begin{tcolorbox}[colback=corclara, colframe=corprincipal, title=Aviso de Compilação]
  Este arquivo (\texttt{configuracoes.tex}) contém apenas as definições de estilo, pacotes e comandos.\\
  
  Ele foi compilado isoladamente na tela com sucesso para evitar erros, mas para visualizar o conteúdo real do seu livro de Cálculo, certifique-se de compilar o arquivo principal (\texttt{main.tex}) ou os arquivos de capítulos individualmente.
  \end{tcolorbox}
  \end{document}
\fi